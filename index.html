<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìˆ˜í•™ ì •ê¸€ ì–´ë“œë²¤ì²˜ - Math Jungle Adventure</title>
    <!-- Google Fonts: Jua (Korean), Outfit (Numbers/English) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Outfit:wght@400;700;900&display=swap" rel="stylesheet">
    <script>
        // Cache Busting CSS
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = 'style.css?v=' + new Date().getTime();
        document.head.appendChild(link);
    </script>
</head>
<body>
    <div id="app">
        <!-- Background Layer -->
        <div class="background-layer">
            <div class="cloud cloud-1"></div>
            <div class="cloud cloud-2"></div>
            <div class="jungle-bg"></div>
        </div>

        <!-- UI Interactive Layer -->
        <main class="game-container glass-panel">
            
            <!-- Screen 1: Title & Grade Selection -->
            <section id="screen-title" class="screen active">
                <h1 class="game-title">ìˆ˜í•™ ì •ê¸€<br>ì–´ë“œë²¤ì²˜</h1>
                <p class="subtitle">ë‹¨ê³„ë¥¼ ì„ íƒí•˜ê³  ëª¨í—˜ì„ ë– ë‚˜ìš”!</p>
                
                <div class="subject-toggle">
                    <button class="btn-subject active" data-subject="math">ğŸ“ ìˆ˜í•™</button>
                    <button class="btn-subject" data-subject="literacy">ğŸ“š êµ­ì–´</button>
                </div>

                <div class="title-coin-display">ğŸª™ <span id="title-coins">0</span></div>
                <div class="title-equipped">
                    <span id="title-character">ğŸµ</span>
                    <span id="title-badge" class="title-badge"></span>
                </div>

                <div class="grade-selector">
                    <button class="btn-grade" data-grade="1">
                        <span class="grade-num">1</span>
                        <span class="grade-text">ê¸°ì´ˆ íƒ„íƒ„<br>(ìˆ˜ ì„¸ê¸°)</span>
                    </button>
                    <button class="btn-grade" data-grade="2">
                        <span class="grade-num">2</span>
                        <span class="grade-text">ë§ì…ˆ ëº„ì…ˆ<br>(ì—°ì‚°)</span>
                    </button>
                    <button class="btn-grade" data-grade="3">
                        <span class="grade-num">3</span>
                        <span class="grade-text">êµ¬êµ¬ë‹¨<br>(ê³±ì…ˆ)</span>
                    </button>
                    <button class="btn-grade" data-grade="4">
                        <span class="grade-num">4</span>
                        <span class="grade-text">ë‚˜ëˆ—ì…ˆ<br>(ì‹¬í™”)</span>
                    </button>
                </div>

                <div class="title-nav-buttons">
                    <button class="btn-nav-icon" id="btn-open-shop">ğŸª<br><small>ìƒì </small></button>
                    <button class="btn-nav-icon" id="btn-open-titles">ğŸ…<br><small>ì¹­í˜¸</small></button>
                </div>
            </section>

            <!-- Screen 2: Stage Map (Placeholder) -->
            <section id="screen-map" class="screen hidden">
                <div class="map-header">
                    <button class="btn-back">â† ë’¤ë¡œ</button>
                    <h2>ğŸ—ºï¸ íƒí—˜ ì§€ë„</h2>
                    <div style="width: 80px;"></div>
                </div>
                <div class="stage-grid" id="stage-list">
                    <!-- Stages will be allowed via JS -->
                </div>
            </section>

            <!-- Screen 2.5: Reading Screen (Literacy Mode) -->
            <section id="screen-reading" class="screen hidden">
                <div class="reading-header">
                    <button class="btn-back" id="btn-back-reading">â† ë’¤ë¡œ</button>
                    <h2>ğŸ“– ì½ì–´ë³´ê¸°</h2>
                </div>
                <div class="reading-content-container glass-card">
                    <h3 id="reading-title">ì œëª©</h3>
                    <div id="reading-text" class="reading-text">
                        <!-- Text inserted here -->
                    </div>
                </div>
                <div class="reading-actions">
                    <button class="btn-primary" id="btn-start-quiz">ë¬¸ì œ í’€ê¸° â¡ï¸</button>
                </div>
            </section>

            <!-- Screen 3: Game Play -->
            <section id="screen-game" class="screen hidden">
                <div class="hud">
                    <button class="btn-icon" id="btn-pause">â¸ï¸</button>
                    <div class="hud-item score-box">â­ <span id="score">0</span></div>
                    <div class="hud-item coin-box">ğŸª™ <span id="hud-coins">0</span></div>
                    <div class="hud-item timer-box">â³ <span id="timer">60</span></div>
                    <div class="hud-item progress-bar-container">
                        <div class="progress-bar-fill" id="progress-fill" style="width: 0%"></div>
                    </div>
                </div>

                <div class="game-area">
                    <div class="character-container">
                        <div class="character" id="player-char">ğŸµ</div>
                        <div class="char-level-badge" id="char-level-badge">Lv.1</div>
                        <div class="char-speech" id="char-speech"></div>
                    </div>

                    <div class="problem-board glass-card">
                        <div class="problem-display" id="problem-text">
                            <!-- Problems inserted here -->
                        </div>
                    </div>

                    <div class="answer-options" id="answer-buttons">
                        <!-- Options generated by JS -->
                    </div>
                </div>

                <div class="controls-area">
                    <button class="btn-hint" id="btn-hint">ğŸ’¡ íŒíŠ¸ ë³´ê¸°</button>
                    <button class="btn-hint hidden" id="btn-view-passage">ğŸ“– ì§€ë¬¸ ë³´ê¸°</button>
                </div>
                
                <!-- Pause Modal -->
                <div id="modal-pause" class="modal-overlay hidden">
                    <div class="modal-content glass-panel">
                        <h2>ì¼ì‹œì •ì§€</h2>
                        <div class="modal-buttons">
                            <button class="btn-primary" id="btn-resume">ê³„ì†í•˜ê¸°</button>
                            <button class="btn-secondary" id="btn-exit-map">ì§€ë„(Map)ë¡œ ë‚˜ê°€ê¸°</button>
                            <button class="btn-secondary" id="btn-exit-title">íƒ€ì´í‹€ë¡œ ë‚˜ê°€ê¸°</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Screen 4: Result -->
            <section id="screen-result" class="screen hidden">
                <h2 class="result-title">ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´!</h2>
                <div class="star-rating" id="result-stars">
                    â­â­â­
                </div>
                <p class="final-score">ì ìˆ˜: <span id="final-score-val">1000</span></p>
                <div class="result-coins">
                    <span class="coin-earned">ğŸª™ +<span id="coins-earned">0</span> ì½”ì¸ íšë“!</span>
                    <span class="exp-earned" id="exp-earned"></span>
                </div>
                <div class="result-actions">
                    <button class="btn-primary" id="btn-restart">ğŸ”„ ë‹¤ì‹œ í•˜ê¸°</button>
                    <button class="btn-primary" id="btn-next">â¡ï¸ ë‹¤ìŒ ë‹¨ê³„</button>
                    <button class="btn-secondary" id="btn-result-map">ğŸ—ºï¸ ì§€ë„ë¡œ ë‚˜ê°€ê¸°</button>
                </div>
            </section>

            <!-- Screen 5: Shop -->
            <section id="screen-shop" class="screen hidden">
                <div class="shop-header">
                    <button class="btn-back" id="btn-back-shop">â† ëŒì•„ê°€ê¸°</button>
                    <h2>ğŸª ì •ê¸€ ìƒì </h2>
                    <div class="shop-coins">ğŸª™ <span id="shop-coin-display">0</span></div>
                </div>
                <div class="shop-tabs">
                    <button class="shop-tab active" data-tab="characters">ğŸ¾ ìºë¦­í„°</button>
                    <button class="shop-tab" data-tab="themes">ğŸ¨ í…Œë§ˆ</button>
                </div>
                <div class="shop-grid" id="shop-grid">
                    <!-- JSë¡œ ë™ì  ìƒì„± -->
                </div>
            </section>

            <!-- Screen 6: Titles -->
            <section id="screen-titles" class="screen hidden">
                <div class="shop-header">
                    <button class="btn-back" id="btn-back-titles">â† ëŒì•„ê°€ê¸°</button>
                    <h2>ğŸ… ë‚˜ì˜ ì¹­í˜¸</h2>
                    <div style="width: 80px;"></div>
                </div>
                <div class="titles-grid" id="titles-grid">
                    <!-- JSë¡œ ë™ì  ìƒì„± -->
                </div>
            </section>

        </main>

        <!-- Collapsible Hint Drawer (Moved outside main to prevent scroll impact) -->
        <div id="hint-drawer" class="hint-drawer">
            <div class="drawer-header">
                <span class="drawer-title">ğŸ’¡ íŒíŠ¸</span>
                <button class="btn-fold" id="btn-fold-hint">â–¼ ì ‘ê¸°</button>
            </div>
            <div class="drawer-content" id="hint-area">
                <!-- Hint Content -->
            </div>
        </div>

        <!-- Level Up Modal -->
        <div id="modal-levelup" class="modal-overlay hidden">
            <div class="modal-content glass-panel modal-levelup">
                <div class="levelup-icon" id="levelup-icon">ğŸ‰</div>
                <h2>LEVEL UP!</h2>
                <p id="levelup-text"></p>
                <p class="levelup-bonus" id="levelup-bonus"></p>
                <button class="btn-primary" id="btn-close-levelup">í™•ì¸</button>
            </div>
        </div>

        <!-- Title Unlock Modal -->
        <div id="modal-title-unlock" class="modal-overlay hidden">
            <div class="modal-content glass-panel modal-title-unlock">
                <div class="title-unlock-icon" id="title-unlock-icon">ğŸ…</div>
                <h2>ìƒˆë¡œìš´ ì¹­í˜¸ íšë“!</h2>
                <p id="title-unlock-text"></p>
                <button class="btn-primary" id="btn-close-title-unlock">í™•ì¸</button>
            </div>
        </div>

        <!-- Passage Modal/Drawer (Overlay) -->
        <div id="modal-passage" class="modal-overlay hidden">
            <div class="modal-content glass-panel modal-passage">
                <button class="btn-close-modal" id="btn-close-passage">âœ–</button>
                <h3 id="modal-passage-title">ì œëª©</h3>
                <div id="modal-passage-text" class="reading-text scrollable"></div>
            </div>
        </div>
    </div>
    
    <script>
        // Cache Busting JS
        var script = document.createElement('script');
        script.src = 'game.js?v=' + new Date().getTime();
        document.body.appendChild(script);
    </script>
</body>
</html>
